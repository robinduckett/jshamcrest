

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Writing Custom Matchers &mdash; JsHamcrest 0.6.7 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="JsHamcrest 0.6.7 documentation" href="index.html" />
    <link rel="next" title="JsHamcrest API Reference" href="modules/index.html" />
    <link rel="prev" title="Uses Of JsHamcrest" href="uses.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules/index.html" title="JsHamcrest API Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="uses.html" title="Uses Of JsHamcrest"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">JsHamcrest 0.6.7 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="writing-custom-matchers">
<span id="custom-matchers"></span><h1>Writing Custom Matchers<a class="headerlink" href="#writing-custom-matchers" title="Permalink to this headline">¶</a></h1>
<p>JsHamcrest already provides a large set of matchers, but that doesn&#8217;t mean you
should stick with those. In fact, we encourage you to create your own matchers
every time you feel the need for something more suitable to the problem you
have in hand.</p>
<div class="section" id="a-basic-example">
<h2>A Basic Example<a class="headerlink" href="#a-basic-example" title="Permalink to this headline">¶</a></h2>
<p>To introduce you to this topic, we are going to implement a new matcher whose
task is just say whether the actual number is the answer to life, the universe,
and everything. This is not a very useful matcher, but it shows everything you
need to create a basic matcher:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">theAnswerToLifeTheUniverseAndEverything</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">SimpleMatcher</span><span class="p">({</span>
        <span class="nx">matches</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">actual</span> <span class="o">==</span> <span class="mi">42</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="nx">describeTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">description</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">description</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;the answer to life, the universe, and everything&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>
</pre></div>
</div>
<p>As you can see, a matcher is nothing more than a function that returns a
<a class="reference internal" href="modules/jshamcrest.html#JsHamcrest.SimpleMatcher" title="JsHamcrest.SimpleMatcher"><tt class="xref py py-class docutils literal"><span class="pre">JsHamcrest.SimpleMatcher</span></tt></a> object . All this particular matcher does is
test whether the actual number is equal to 42.</p>
<p>Okay, let&#8217;s put that matcher to use:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// Output: Expected the answer to life, the universe, and everything: Success</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="nx">theAnswerToLifeTheUniverseAndEverything</span><span class="p">());</span>

<span class="c1">// Output: Expected the answer to life, the universe, and everything but was 10</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">theAnswerToLifeTheUniverseAndEverything</span><span class="p">());</span>
</pre></div>
</div>
<div class="section" id="do-i-need-custom-matchers">
<h3>Do I Need Custom Matchers?<a class="headerlink" href="#do-i-need-custom-matchers" title="Permalink to this headline">¶</a></h3>
<p>But wouldn&#8217;t it be simpler if we just use the
<a class="reference internal" href="modules/matchers.html#JsHamcrest.Matchers.equalTo" title="JsHamcrest.Matchers.equalTo"><tt class="xref py py-meth docutils literal"><span class="pre">JsHamcrest.Matchers.equalTo()</span></tt></a> matcher instead? Let&#8217;s see an example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// Output: Expected equal to 42: Success</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="nx">equalTo</span><span class="p">(</span><span class="mi">42</span><span class="p">));</span>

<span class="c1">// Output: Expected equal to 42 but was 10</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">equalTo</span><span class="p">(</span><span class="mi">42</span><span class="p">));</span>
</pre></div>
</div>
<p>At the end, the result is the same. The only downside though is that we lose
the ability to describe the assertion with a meaningful language, more
appropriate to the problem we need to solve.</p>
</div>
<div class="section" id="composing-matchers">
<h3>Composing Matchers<a class="headerlink" href="#composing-matchers" title="Permalink to this headline">¶</a></h3>
<p>You can use your custom matchers together with the built-in ones to compose even
more interesting match rules. For example, if you want to match when a number
<em>is not</em> the answer to life, the universe, and everything, just wrap your custom
matcher with a <a class="reference internal" href="modules/matchers.html#JsHamcrest.Matchers.not" title="JsHamcrest.Matchers.not"><tt class="xref py py-meth docutils literal"><span class="pre">JsHamcrest.Matchers.not()</span></tt></a> matcher and you&#8217;re done:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// Output: Expected not the answer to life, the universe, and everything: Success</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">not</span><span class="p">(</span><span class="nx">theAnswerToLifeTheUniverseAndEverything</span><span class="p">()));</span>

<span class="c1">// Output: Expected not the answer to life, the universe, and everything but was 42</span>
<span class="nx">assertThat</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="nx">not</span><span class="p">(</span><span class="nx">theAnswerToLifeTheUniverseAndEverything</span><span class="p">()));</span>
</pre></div>
</div>
<p>That way you get the best of both worlds.</p>
</div>
</div>
<div class="section" id="learning-by-example">
<h2>Learning By Example<a class="headerlink" href="#learning-by-example" title="Permalink to this headline">¶</a></h2>
<p>Another great way to learn how to implement new matchers is to look at the
<a class="reference internal" href="modules/matchers.html#module-matchers"><em>existing ones</em></a>. There&#8217;s plenty of examples, of various
levels of complexity.</p>
<p>For instance, take a look at the source code of the
<a class="reference internal" href="modules/matchers.html#JsHamcrest.Matchers.hasSize" title="JsHamcrest.Matchers.hasSize"><tt class="xref py py-meth docutils literal"><span class="pre">JsHamcrest.Matchers.hasSize()</span></tt></a> matcher:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">Matchers</span><span class="p">.</span><span class="nx">hasSize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">matcherOrValue</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Uses &#39;equalTo&#39; matcher if the given object is not a matcher</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">isMatcher</span><span class="p">(</span><span class="nx">matcherOrValue</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">matcherOrValue</span> <span class="o">=</span> <span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">Matchers</span><span class="p">.</span><span class="nx">equalTo</span><span class="p">(</span><span class="nx">matcherOrValue</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">SimpleMatcher</span><span class="p">({</span>
        <span class="nx">matches</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">matcherOrValue</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">actual</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">describeTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">description</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">description</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;has size &#39;</span><span class="p">).</span><span class="nx">appendDescriptionOf</span><span class="p">(</span><span class="nx">matcherOrValue</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="nx">describeValueTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">description</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">description</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">actual</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>
</pre></div>
</div>
<p>This matcher is prepared to use either matchers or numbers as the expected
array size:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">assertThat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="nx">hasSize</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="nx">assertThat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="nx">hasSize</span><span class="p">(</span><span class="nx">lessThan</span><span class="p">(</span><span class="mi">5</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="section" id="distributing-your-custom-set-of-matchers">
<h2>Distributing Your Custom Set Of Matchers<a class="headerlink" href="#distributing-your-custom-set-of-matchers" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s suppose you have a couple of custom matchers you want to distribute to
some people:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// filename: power_matchers.js</span>

<span class="nx">PowerMatchers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">rocks</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">},</span>

    <span class="nx">sucks</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>All you need to do is call <a class="reference internal" href="modules/integration.html#JsHamcrest.Integration.installMatchers" title="JsHamcrest.Integration.installMatchers"><tt class="xref py py-meth docutils literal"><span class="pre">JsHamcrest.Integration.installMatchers()</span></tt></a> at the
end of your script, passing the namespace of your matchers as argument:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// filename: power_matchers.js</span>

<span class="nx">PowerMatchers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">};</span>

<span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">Integration</span><span class="p">.</span><span class="nx">installMatchers</span><span class="p">(</span><span class="nx">PowerMatchers</span><span class="p">);</span>
</pre></div>
</div>
<p>That&#8217;s it. To plug your new matcher library, just link your script after
JsHamcrest itself:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;header&gt;</span>
    <span class="nt">&lt;title&gt;</span>Page title<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;path/to/jshamcrest.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;path/to/power_matchers.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>

    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
        <span class="c1">// Displays the assertion descriptions using web browser&#39;s alert() function</span>
        <span class="nx">JsHamcrest</span><span class="p">.</span><span class="nx">Integration</span><span class="p">.</span><span class="nx">WebBrowser</span><span class="p">();</span>

        <span class="kd">var</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{...},</span> <span class="nx">obj2</span> <span class="o">=</span> <span class="p">{...};</span>

        <span class="nx">assertThat</span><span class="p">(</span><span class="nx">obj1</span><span class="p">,</span> <span class="nx">rocks</span><span class="p">());</span>
        <span class="nx">assertThat</span><span class="p">(</span><span class="nx">obj2</span><span class="p">,</span> <span class="nx">sucks</span><span class="p">());</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/header&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Writing Custom Matchers</a><ul>
<li><a class="reference internal" href="#a-basic-example">A Basic Example</a><ul>
<li><a class="reference internal" href="#do-i-need-custom-matchers">Do I Need Custom Matchers?</a></li>
<li><a class="reference internal" href="#composing-matchers">Composing Matchers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#learning-by-example">Learning By Example</a></li>
<li><a class="reference internal" href="#distributing-your-custom-set-of-matchers">Distributing Your Custom Set Of Matchers</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="uses.html"
                        title="previous chapter">Uses Of JsHamcrest</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules/index.html"
                        title="next chapter">JsHamcrest API Reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/custom_matcher.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules/index.html" title="JsHamcrest API Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="uses.html" title="Uses Of JsHamcrest"
             >previous</a> |</li>
        <li><a href="index.html">JsHamcrest 0.6.7 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2009-2011, Destaquenet Technology Solutions.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-761701-7");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>